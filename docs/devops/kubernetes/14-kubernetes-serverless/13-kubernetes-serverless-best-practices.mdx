---
title: Kubernetes æ— æœåŠ¡å™¨æœ€ä½³å®è·µ
description: äº†è§£å¦‚ä½•åœ¨ Kubernetes ä¸­å®ç°æ— æœåŠ¡å™¨æ¶æ„çš„æœ€ä½³å®è·µï¼ŒåŒ…æ‹¬æ ¸å¿ƒæ¦‚å¿µã€å®é™…åº”ç”¨åœºæ™¯å’Œä»£ç ç¤ºä¾‹ã€‚
---

# Kubernetes æ— æœåŠ¡å™¨æœ€ä½³å®è·µ

## ä»‹ç»

æ— æœåŠ¡å™¨ï¼ˆServerlessï¼‰æ¶æ„æ˜¯ä¸€ç§äº‘è®¡ç®—æ¨¡å‹ï¼Œå¼€å‘è€…æ— éœ€ç®¡ç†åº•å±‚åŸºç¡€è®¾æ–½å³å¯è¿è¡Œä»£ç ã€‚Kubernetes ä½œä¸ºå®¹å™¨ç¼–æ’å¹³å°ï¼Œé€šè¿‡æ‰©å±•å’Œå·¥å…·ï¼ˆå¦‚ Knative å’Œ OpenFaaSï¼‰æ”¯æŒæ— æœåŠ¡å™¨æ¶æ„ã€‚æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•åœ¨ Kubernetes ä¸­å®ç°æ— æœåŠ¡å™¨æ¶æ„çš„æœ€ä½³å®è·µï¼Œå¸®åŠ©åˆå­¦è€…å¿«é€Ÿä¸Šæ‰‹ã€‚

:::note
æ— æœåŠ¡å™¨å¹¶ä¸æ„å‘³ç€æ²¡æœ‰æœåŠ¡å™¨ï¼Œè€Œæ˜¯å¼€å‘è€…æ— éœ€å…³å¿ƒæœåŠ¡å™¨çš„ç®¡ç†å’Œç»´æŠ¤ã€‚
:::

---

## æ ¸å¿ƒæ¦‚å¿µ

### 1. æ— æœåŠ¡å™¨æ¶æ„çš„æ ¸å¿ƒç»„ä»¶
åœ¨ Kubernetes ä¸­å®ç°æ— æœåŠ¡å™¨æ¶æ„é€šå¸¸ä¾èµ–äºä»¥ä¸‹ç»„ä»¶ï¼š
- **Knative**ï¼šä¸€ä¸ªå¼€æºå¹³å°ï¼Œç”¨äºåœ¨ Kubernetes ä¸Šæ„å»ºã€éƒ¨ç½²å’Œç®¡ç†æ— æœåŠ¡å™¨å·¥ä½œè´Ÿè½½ã€‚
- **OpenFaaS**ï¼šä¸€ä¸ªå¼€æºæ¡†æ¶ï¼Œç”¨äºå°†å‡½æ•°éƒ¨ç½²ä¸ºæ— æœåŠ¡å™¨æœåŠ¡ã€‚
- **Kubernetes Event-Driven Autoscaling (KEDA)**ï¼šç”¨äºæ ¹æ®äº‹ä»¶è‡ªåŠ¨æ‰©å±•å·¥ä½œè´Ÿè½½ã€‚

### 2. æ— æœåŠ¡å™¨çš„ä¼˜åŠ¿
- **è‡ªåŠ¨æ‰©å±•**ï¼šæ ¹æ®æµé‡è‡ªåŠ¨æ‰©å±•æˆ–ç¼©å‡èµ„æºã€‚
- **æŒ‰éœ€ä»˜è´¹**ï¼šä»…åœ¨å®é™…è¿è¡Œæ—¶è®¡è´¹ã€‚
- **ç®€åŒ–è¿ç»´**ï¼šæ— éœ€ç®¡ç†æœåŠ¡å™¨æˆ–åŸºç¡€è®¾æ–½ã€‚

---

## æœ€ä½³å®è·µ

### 1. ä½¿ç”¨ Knative éƒ¨ç½²æ— æœåŠ¡å™¨åº”ç”¨
Knative æ˜¯ Kubernetes ä¸Šå®ç°æ— æœåŠ¡å™¨æ¶æ„çš„æµè¡Œå·¥å…·ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨ Knative éƒ¨ç½²ä¸€ä¸ªç®€å•åº”ç”¨çš„æ­¥éª¤ã€‚

#### æ­¥éª¤ 1ï¼šå®‰è£… Knative
é¦–å…ˆï¼Œç¡®ä¿ Kubernetes é›†ç¾¤å·²å®‰è£… Knativeã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å®‰è£… Knative Servingï¼š

```bash
kubectl apply -f https://github.com/knative/serving/releases/download/knative-v1.9.0/serving-crds.yaml
kubectl apply -f https://github.com/knative/serving/releases/download/knative-v1.9.0/serving-core.yaml
```

#### æ­¥éª¤ 2ï¼šéƒ¨ç½²æ— æœåŠ¡å™¨æœåŠ¡
åˆ›å»ºä¸€ä¸ª Knative æœåŠ¡é…ç½®æ–‡ä»¶ `service.yaml`ï¼š

```yaml
apiVersion: serving.knative.dev/v1
kind: Service
metadata:
  name: hello-world
spec:
  template:
    spec:
      containers:
        - image: gcr.io/knative-samples/helloworld-go
          env:
            - name: TARGET
              value: "World"
```

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤éƒ¨ç½²æœåŠ¡ï¼š

```bash
kubectl apply -f service.yaml
```

#### æ­¥éª¤ 3ï¼šè®¿é—®æœåŠ¡
Knative ä¼šè‡ªåŠ¨ä¸ºæœåŠ¡åˆ†é…ä¸€ä¸ªåŸŸåã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤è·å–æœåŠ¡çš„ URLï¼š

```bash
kubectl get ksvc hello-world
```

è®¿é—®è¯¥ URLï¼Œä½ å°†çœ‹åˆ°è¾“å‡ºï¼š

```
Hello World!
```

:::tip
Knative ä¼šè‡ªåŠ¨å°†æœåŠ¡ç¼©æ”¾åˆ°é›¶ï¼Œå½“æ²¡æœ‰è¯·æ±‚æ—¶ä¸ä¼šæ¶ˆè€—èµ„æºã€‚
:::

---

### 2. ä½¿ç”¨ KEDA å®ç°äº‹ä»¶é©±åŠ¨çš„è‡ªåŠ¨æ‰©å±•
KEDA æ˜¯ä¸€ä¸ª Kubernetes æ‰©å±•ï¼Œç”¨äºæ ¹æ®äº‹ä»¶ï¼ˆå¦‚æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯æ•°é‡ï¼‰è‡ªåŠ¨æ‰©å±•å·¥ä½œè´Ÿè½½ã€‚

#### ç¤ºä¾‹ï¼šåŸºäº RabbitMQ çš„è‡ªåŠ¨æ‰©å±•
å‡è®¾ä½ æœ‰ä¸€ä¸ªä» RabbitMQ é˜Ÿåˆ—ä¸­æ¶ˆè´¹æ¶ˆæ¯çš„åº”ç”¨ï¼Œä»¥ä¸‹æ˜¯ä½¿ç”¨ KEDA å®ç°è‡ªåŠ¨æ‰©å±•çš„æ­¥éª¤ã€‚

#### æ­¥éª¤ 1ï¼šå®‰è£… KEDA
ä½¿ç”¨ Helm å®‰è£… KEDAï¼š

```bash
helm repo add kedacore https://kedacore.github.io/charts
helm repo update
helm install keda kedacore/keda --namespace keda --create-namespace
```

#### æ­¥éª¤ 2ï¼šåˆ›å»º ScaledObject
åˆ›å»ºä¸€ä¸ª `ScaledObject.yaml` æ–‡ä»¶ï¼Œå®šä¹‰åŸºäº RabbitMQ é˜Ÿåˆ—çš„è‡ªåŠ¨æ‰©å±•è§„åˆ™ï¼š

```yaml
apiVersion: keda.sh/v1alpha1
kind: ScaledObject
metadata:
  name: rabbitmq-scaledobject
  namespace: default
spec:
  scaleTargetRef:
    name: my-consumer-app
  triggers:
    - type: rabbitmq
      metadata:
        queueName: my-queue
        host: amqp://user:password@rabbitmq.default.svc.cluster.local:5672/
        queueLength: "10"
```

åº”ç”¨è¯¥é…ç½®ï¼š

```bash
kubectl apply -f ScaledObject.yaml
```

:::caution
ç¡®ä¿ RabbitMQ çš„åœ°å€å’Œå‡­è¯æ­£ç¡®ã€‚
:::

---

## å®é™…åº”ç”¨åœºæ™¯

### åœºæ™¯ 1ï¼šå®æ—¶æ•°æ®å¤„ç†
å‡è®¾ä½ éœ€è¦å¤„ç†æ¥è‡ª IoT è®¾å¤‡çš„å®æ—¶æ•°æ®æµã€‚å¯ä»¥ä½¿ç”¨ Knative éƒ¨ç½²ä¸€ä¸ªæ— æœåŠ¡å™¨å‡½æ•°ï¼Œå½“æ•°æ®åˆ°è¾¾æ—¶è‡ªåŠ¨è§¦å‘å¤„ç†é€»è¾‘ã€‚

### åœºæ™¯ 2ï¼šäº‹ä»¶é©±åŠ¨çš„å¾®æœåŠ¡
åœ¨ç”µå•†å¹³å°ä¸­ï¼Œè®¢å•åˆ›å»ºäº‹ä»¶å¯ä»¥è§¦å‘åº“å­˜æ›´æ–°ã€æ”¯ä»˜å¤„ç†ç­‰æ“ä½œã€‚ä½¿ç”¨ KEDA å¯ä»¥æ ¹æ®è®¢å•é˜Ÿåˆ—çš„é•¿åº¦è‡ªåŠ¨æ‰©å±•å¤„ç†æœåŠ¡ã€‚

---

## æ€»ç»“

Kubernetes æ— æœåŠ¡å™¨æ¶æ„é€šè¿‡ Knativeã€OpenFaaS å’Œ KEDA ç­‰å·¥å…·ï¼Œä¸ºå¼€å‘è€…æä¾›äº†å¼ºå¤§çš„è‡ªåŠ¨æ‰©å±•å’Œäº‹ä»¶é©±åŠ¨èƒ½åŠ›ã€‚é€šè¿‡éµå¾ªæœ€ä½³å®è·µï¼Œä½ å¯ä»¥è½»æ¾æ„å»ºé«˜æ•ˆã€å¯æ‰©å±•çš„æ— æœåŠ¡å™¨åº”ç”¨ã€‚

---

## é™„åŠ èµ„æºä¸ç»ƒä¹ 

### èµ„æº
- [Knative å®˜æ–¹æ–‡æ¡£](https://knative.dev/docs/)
- [KEDA å®˜æ–¹æ–‡æ¡£](https://keda.sh/docs/)
- [OpenFaaS å®˜æ–¹æ–‡æ¡£](https://docs.openfaas.com/)

### ç»ƒä¹ 
1. ä½¿ç”¨ Knative éƒ¨ç½²ä¸€ä¸ªç®€å•çš„ Python æ— æœåŠ¡å™¨å‡½æ•°ã€‚
2. ä½¿ç”¨ KEDA å®ç°åŸºäº Kafka çš„è‡ªåŠ¨æ‰©å±•ã€‚
3. å°è¯•å°†ç°æœ‰çš„å¾®æœåŠ¡è¿ç§»åˆ°æ— æœåŠ¡å™¨æ¶æ„ã€‚

Happy Coding! ğŸš€