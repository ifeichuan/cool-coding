---
title: Next.js React Testing Library
description: "å­¦ä¹ å¦‚ä½•åœ¨ Next.js é¡¹ç›®ä¸­ä½¿ç”¨ React Testing Library è¿›è¡Œç»„ä»¶æµ‹è¯•ã€‚æœ¬æŒ‡å—é€‚åˆåˆå­¦è€…ï¼Œæ¶µç›–åŸºæœ¬æ¦‚å¿µã€ä»£ç ç¤ºä¾‹å’Œå®é™…åº”ç”¨åœºæ™¯ã€‚"
---

# Next.js React Testing Library

åœ¨å¼€å‘ Next.js åº”ç”¨æ—¶ï¼Œç¡®ä¿ç»„ä»¶çš„æ­£ç¡®æ€§å’Œç¨³å®šæ€§è‡³å…³é‡è¦ã€‚React Testing Library æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬ç¼–å†™å¯ç»´æŠ¤çš„æµ‹è¯•ç”¨ä¾‹ï¼Œç¡®ä¿ç»„ä»¶æŒ‰é¢„æœŸå·¥ä½œã€‚æœ¬æ–‡å°†å¸¦ä½ ä»é›¶å¼€å§‹å­¦ä¹ å¦‚ä½•åœ¨ Next.js é¡¹ç›®ä¸­ä½¿ç”¨ React Testing Library è¿›è¡Œæµ‹è¯•ã€‚

## ä»€ä¹ˆæ˜¯ React Testing Libraryï¼Ÿ

React Testing Library æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯• React ç»„ä»¶çš„åº“ï¼Œå®ƒé¼“åŠ±å¼€å‘è€…ä»¥ç”¨æˆ·çš„è§’åº¦ç¼–å†™æµ‹è¯•ã€‚ä¸ä¼ ç»Ÿçš„æµ‹è¯•å·¥å…·ä¸åŒï¼ŒReact Testing Library ä¸å…³æ³¨ç»„ä»¶çš„å†…éƒ¨å®ç°ç»†èŠ‚ï¼Œè€Œæ˜¯å…³æ³¨ç»„ä»¶çš„è¡Œä¸ºå’Œè¾“å‡ºã€‚è¿™ä½¿å¾—æµ‹è¯•æ›´å…·å¯ç»´æŠ¤æ€§ï¼Œå¹¶ä¸”æ›´è´´è¿‘å®é™…ç”¨æˆ·çš„ä½¿ç”¨åœºæ™¯ã€‚

## å®‰è£… React Testing Library

åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ Next.js é¡¹ç›®ä¸­å®‰è£… React Testing Library å’Œç›¸å…³çš„ä¾èµ–é¡¹ã€‚è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
npm install --save-dev @testing-library/react @testing-library/jest-dom
```

- `@testing-library/react`ï¼šæä¾› React Testing Library çš„æ ¸å¿ƒåŠŸèƒ½ã€‚
- `@testing-library/jest-dom`ï¼šä¸º Jest æä¾›é¢å¤–çš„ DOM æ–­è¨€æ–¹æ³•ã€‚

## ç¼–å†™ç¬¬ä¸€ä¸ªæµ‹è¯•

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„ç»„ä»¶ `Greeting`ï¼Œå®ƒæ ¹æ®ä¼ å…¥çš„ `name` å±æ€§æ˜¾ç¤ºé—®å€™è¯­ï¼š

```jsx
// components/Greeting.js
export default function Greeting({ name }) {
  return <h1>Hello, {name}!</h1>;
}
```

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä¸ºè¿™ä¸ªç»„ä»¶ç¼–å†™ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶ `Greeting.test.js`ï¼š

```jsx
// components/Greeting.test.js
import { render, screen } from '@testing-library/react';
import Greeting from './Greeting';

test('renders greeting with name', () => {
  render(<Greeting name="Alice" />);
  const greetingElement = screen.getByText(/Hello, Alice!/i);
  expect(greetingElement).toBeInTheDocument();
});
```

### ä»£ç è§£é‡Š

1. **`render`**ï¼šç”¨äºæ¸²æŸ“ç»„ä»¶ã€‚
2. **`screen`**ï¼šæä¾›æŸ¥è¯¢ DOM å…ƒç´ çš„æ–¹æ³•ã€‚
3. **`getByText`**ï¼šæŸ¥æ‰¾åŒ…å«æŒ‡å®šæ–‡æœ¬çš„å…ƒç´ ã€‚
4. **`expect`**ï¼šæ–­è¨€å…ƒç´ æ˜¯å¦å­˜åœ¨äºæ–‡æ¡£ä¸­ã€‚

è¿è¡Œæµ‹è¯•ï¼š

```bash
npm test
```

å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œæµ‹è¯•å°†é€šè¿‡ï¼Œå¹¶è¾“å‡ºç±»ä¼¼ä»¥ä¸‹å†…å®¹ï¼š

```
PASS  components/Greeting.test.js
  âœ“ renders greeting with name (20 ms)
```

## æµ‹è¯•ç”¨æˆ·äº¤äº’

React Testing Library ä¸ä»…å¯ä»¥æµ‹è¯•é™æ€å†…å®¹ï¼Œè¿˜å¯ä»¥æ¨¡æ‹Ÿç”¨æˆ·äº¤äº’ã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæŒ‰é’®ç»„ä»¶ `Counter`ï¼Œç‚¹å‡»æŒ‰é’®ä¼šå¢åŠ è®¡æ•°ï¼š

```jsx
// components/Counter.js
import { useState } from 'react';

export default function Counter() {
  const [count, setCount] = useState(0);

  return (
    <div>
      <button onClick={() => setCount(count + 1)}>Increment</button>
      <span data-testid="count">{count}</span>
    </div>
  );
}
```

æˆ‘ä»¬å¯ä»¥ç¼–å†™ä»¥ä¸‹æµ‹è¯•æ¥éªŒè¯æŒ‰é’®ç‚¹å‡»è¡Œä¸ºï¼š

```jsx
// components/Counter.test.js
import { render, screen, fireEvent } from '@testing-library/react';
import Counter from './Counter';

test('increments count on button click', () => {
  render(<Counter />);
  const button = screen.getByText(/Increment/i);
  const countElement = screen.getByTestId('count');

  expect(countElement).toHaveTextContent('0');

  fireEvent.click(button);
  expect(countElement).toHaveTextContent('1');

  fireEvent.click(button);
  expect(countElement).toHaveTextContent('2');
});
```

### ä»£ç è§£é‡Š

1. **`fireEvent`**ï¼šç”¨äºæ¨¡æ‹Ÿç”¨æˆ·äº‹ä»¶ï¼Œå¦‚ç‚¹å‡»ã€è¾“å…¥ç­‰ã€‚
2. **`toHaveTextContent`**ï¼šæ–­è¨€å…ƒç´ æ˜¯å¦åŒ…å«æŒ‡å®šçš„æ–‡æœ¬å†…å®¹ã€‚

## å®é™…åº”ç”¨åœºæ™¯

åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæµ‹è¯•å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç¡®ä¿ä»¥ä¸‹åœºæ™¯çš„æ­£ç¡®æ€§ï¼š

1. **è¡¨å•éªŒè¯**ï¼šæµ‹è¯•ç”¨æˆ·è¾“å…¥æ˜¯å¦è§¦å‘æ­£ç¡®çš„éªŒè¯é€»è¾‘ã€‚
2. **è·¯ç”±å¯¼èˆª**ï¼šæµ‹è¯•ç‚¹å‡»é“¾æ¥æˆ–æŒ‰é’®æ˜¯å¦å¯¼èˆªåˆ°æ­£ç¡®çš„é¡µé¢ã€‚
3. **API è°ƒç”¨**ï¼šæµ‹è¯•ç»„ä»¶æ˜¯å¦æ­£ç¡®å¤„ç†å¼‚æ­¥æ•°æ®åŠ è½½å’Œé”™è¯¯çŠ¶æ€ã€‚

ä¾‹å¦‚ï¼Œæµ‹è¯•ä¸€ä¸ªç™»å½•è¡¨å•ï¼š

```jsx
// components/LoginForm.test.js
import { render, screen, fireEvent } from '@testing-library/react';
import LoginForm from './LoginForm';

test('submits form with username and password', () => {
  const handleSubmit = jest.fn();
  render(<LoginForm onSubmit={handleSubmit} />);

  const usernameInput = screen.getByLabelText(/Username/i);
  const passwordInput = screen.getByLabelText(/Password/i);
  const submitButton = screen.getByText(/Submit/i);

  fireEvent.change(usernameInput, { target: { value: 'alice' } });
  fireEvent.change(passwordInput, { target: { value: 'password123' } });
  fireEvent.click(submitButton);

  expect(handleSubmit).toHaveBeenCalledWith({
    username: 'alice',
    password: 'password123',
  });
});
```

## æ€»ç»“

é€šè¿‡ React Testing Libraryï¼Œæˆ‘ä»¬å¯ä»¥ç¼–å†™æ›´è´´è¿‘ç”¨æˆ·è¡Œä¸ºçš„æµ‹è¯•ï¼Œç¡®ä¿ç»„ä»¶çš„æ­£ç¡®æ€§å’Œç¨³å®šæ€§ã€‚æœ¬æ–‡ä»‹ç»äº†å¦‚ä½•å®‰è£…å’Œé…ç½® React Testing Libraryï¼Œå¹¶å±•ç¤ºäº†å¦‚ä½•æµ‹è¯•é™æ€å†…å®¹ã€ç”¨æˆ·äº¤äº’ä»¥åŠå®é™…åº”ç”¨åœºæ™¯ã€‚

:::tip
ä¸ºäº†è¿›ä¸€æ­¥å·©å›ºä½ çš„çŸ¥è¯†ï¼Œå°è¯•ä¸ºä½ çš„ Next.js é¡¹ç›®ä¸­çš„å…¶ä»–ç»„ä»¶ç¼–å†™æµ‹è¯•ï¼Œå¹¶æ¢ç´¢æ›´å¤š React Testing Library çš„é«˜çº§åŠŸèƒ½ï¼Œå¦‚ `waitFor` å’Œ `findBy`ã€‚
:::

## é™„åŠ èµ„æº

- [React Testing Library å®˜æ–¹æ–‡æ¡£](https://testing-library.com/docs/react-testing-library/intro/)
- [Jest å®˜æ–¹æ–‡æ¡£](https://jestjs.io/docs/getting-started)
- [Next.js æµ‹è¯•æŒ‡å—](https://nextjs.org/docs/testing)

Happy testing! ğŸš€