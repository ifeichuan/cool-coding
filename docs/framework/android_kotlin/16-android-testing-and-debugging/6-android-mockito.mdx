---
title: Android Mockito
description: "å­¦ä¹ å¦‚ä½•ä½¿ç”¨ Mockito åœ¨ Android ä¸­è¿›è¡Œå•å…ƒæµ‹è¯•å’Œæ¨¡æ‹Ÿå¯¹è±¡ã€‚æœ¬æ–‡é€‚åˆåˆå­¦è€…ï¼ŒåŒ…å«ä»£ç ç¤ºä¾‹å’Œå®é™…æ¡ˆä¾‹ã€‚"
---

## ä»‹ç»

åœ¨ Android å¼€å‘ä¸­ï¼Œæµ‹è¯•æ˜¯ç¡®ä¿åº”ç”¨ç¨‹åºè´¨é‡çš„å…³é”®æ­¥éª¤ã€‚Mockito æ˜¯ä¸€ä¸ªæµè¡Œçš„ Java æµ‹è¯•æ¡†æ¶ï¼Œä¸“é—¨ç”¨äºåˆ›å»ºæ¨¡æ‹Ÿå¯¹è±¡ï¼ˆmock objectsï¼‰ã€‚æ¨¡æ‹Ÿå¯¹è±¡å…è®¸ä½ åœ¨æµ‹è¯•ä¸­æ¨¡æ‹Ÿä¾èµ–é¡¹çš„è¡Œä¸ºï¼Œä»è€Œéš”ç¦»å’ŒéªŒè¯ä»£ç çš„ç‰¹å®šéƒ¨åˆ†ã€‚

Mockito çš„ä¸»è¦ç”¨é€”åŒ…æ‹¬ï¼š
- æ¨¡æ‹Ÿä¾èµ–é¡¹çš„è¡Œä¸ºã€‚
- éªŒè¯æ–¹æ³•è°ƒç”¨ã€‚
- ç®€åŒ–å•å…ƒæµ‹è¯•ã€‚

æœ¬æ–‡å°†é€æ­¥ä»‹ç»å¦‚ä½•åœ¨ Android é¡¹ç›®ä¸­ä½¿ç”¨ Mockitoï¼Œå¹¶é€šè¿‡å®é™…æ¡ˆä¾‹å±•ç¤ºå…¶åº”ç”¨ã€‚

---

## å®‰è£… Mockito

åœ¨å¼€å§‹ä½¿ç”¨ Mockito ä¹‹å‰ï¼Œä½ éœ€è¦åœ¨é¡¹ç›®ä¸­æ·»åŠ ä¾èµ–é¡¹ã€‚æ‰“å¼€ `build.gradle` æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š

```groovy
dependencies {
    testImplementation 'org.mockito:mockito-core:4.0.0'
    androidTestImplementation 'org.mockito:mockito-android:4.0.0'
}
```

:::note
ç¡®ä¿ä½ ä½¿ç”¨çš„æ˜¯æœ€æ–°ç‰ˆæœ¬çš„ Mockitoã€‚ä½ å¯ä»¥è®¿é—® [Mockito å®˜æ–¹ GitHub](https://github.com/mockito/mockito) æŸ¥çœ‹æœ€æ–°ç‰ˆæœ¬ã€‚
:::

---

## åŸºæœ¬ç”¨æ³•

### åˆ›å»ºæ¨¡æ‹Ÿå¯¹è±¡

Mockito çš„æ ¸å¿ƒåŠŸèƒ½æ˜¯åˆ›å»ºæ¨¡æ‹Ÿå¯¹è±¡ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•æ¨¡æ‹Ÿä¸€ä¸ª `List` å¯¹è±¡ï¼š

```java
import org.mockito.Mockito;
import java.util.List;

public class ExampleTest {
    public void testMockList() {
        // åˆ›å»ºæ¨¡æ‹Ÿå¯¹è±¡
        List<String> mockedList = Mockito.mock(List.class);

        // è®¾ç½®æ¨¡æ‹Ÿè¡Œä¸º
        Mockito.when(mockedList.get(0)).thenReturn("Mockito");

        // éªŒè¯æ¨¡æ‹Ÿè¡Œä¸º
        System.out.println(mockedList.get(0)); // è¾“å‡º: Mockito
    }
}
```

:::tip
`Mockito.mock()` æ–¹æ³•ç”¨äºåˆ›å»ºæ¨¡æ‹Ÿå¯¹è±¡ã€‚`Mockito.when()` ç”¨äºå®šä¹‰æ¨¡æ‹Ÿå¯¹è±¡çš„è¡Œä¸ºã€‚
:::

### éªŒè¯æ–¹æ³•è°ƒç”¨

Mockito è¿˜å¯ä»¥éªŒè¯æ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨ã€‚ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•éªŒè¯ `add` æ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨ï¼š

```java
import org.mockito.Mockito;
import java.util.List;

public class ExampleTest {
    public void testVerifyMethodCall() {
        List<String> mockedList = Mockito.mock(List.class);

        // è°ƒç”¨æ–¹æ³•
        mockedList.add("Mockito");

        // éªŒè¯æ–¹æ³•æ˜¯å¦è¢«è°ƒç”¨
        Mockito.verify(mockedList).add("Mockito");
    }
}
```

:::caution
å¦‚æœ `add` æ–¹æ³•æœªè¢«è°ƒç”¨ï¼Œ`Mockito.verify()` å°†æŠ›å‡ºå¼‚å¸¸ã€‚
:::

---

## å®é™…æ¡ˆä¾‹

### æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚

åœ¨ Android å¼€å‘ä¸­ï¼Œç½‘ç»œè¯·æ±‚é€šå¸¸æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œã€‚ä¸ºäº†æµ‹è¯•ä¾èµ–äºç½‘ç»œè¯·æ±‚çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Mockito æ¨¡æ‹Ÿç½‘ç»œè¯·æ±‚çš„è¡Œä¸ºã€‚

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œå±•ç¤ºå¦‚ä½•æ¨¡æ‹Ÿ Retrofit çš„ç½‘ç»œè¯·æ±‚ï¼š

```java
import retrofit2.Call;
import retrofit2.Response;
import org.mockito.Mockito;

public class NetworkTest {
    public void testNetworkRequest() {
        // åˆ›å»ºæ¨¡æ‹Ÿçš„ Retrofit Call å¯¹è±¡
        Call<String> mockedCall = Mockito.mock(Call.class);

        // æ¨¡æ‹ŸæˆåŠŸçš„ç½‘ç»œå“åº”
        Mockito.when(mockedCall.execute()).thenReturn(Response.success("Success"));

        // éªŒè¯æ¨¡æ‹Ÿè¡Œä¸º
        System.out.println(mockedCall.execute().body()); // è¾“å‡º: Success
    }
}
```

:::warning
åœ¨å®é™…æµ‹è¯•ä¸­ï¼Œç¡®ä¿æ¨¡æ‹Ÿçš„è¡Œä¸ºä¸çœŸå®ç½‘ç»œè¯·æ±‚çš„è¡Œä¸ºä¸€è‡´ã€‚
:::

---

## æ€»ç»“

Mockito æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ä½ åœ¨ Android å¼€å‘ä¸­ç¼–å†™æ›´å¯é çš„å•å…ƒæµ‹è¯•ã€‚é€šè¿‡æ¨¡æ‹Ÿå¯¹è±¡ï¼Œä½ å¯ä»¥éš”ç¦»å’ŒéªŒè¯ä»£ç çš„ç‰¹å®šéƒ¨åˆ†ï¼Œè€Œæ— éœ€ä¾èµ–å¤–éƒ¨ç³»ç»Ÿæˆ–å¤æ‚çš„ç¯å¢ƒã€‚

### é™„åŠ èµ„æº
- [Mockito å®˜æ–¹æ–‡æ¡£](https://site.mockito.org/)
- [Android å•å…ƒæµ‹è¯•æŒ‡å—](https://developer.android.com/training/testing/unit-testing)

### ç»ƒä¹ 
1. ä½¿ç”¨ Mockito æ¨¡æ‹Ÿä¸€ä¸ª `User` ç±»ï¼Œå¹¶éªŒè¯å…¶ `getName()` æ–¹æ³•çš„è¡Œä¸ºã€‚
2. å°è¯•æ¨¡æ‹Ÿä¸€ä¸ª Retrofit æ¥å£ï¼Œå¹¶æµ‹è¯•å…¶å¼‚æ­¥å›è°ƒé€»è¾‘ã€‚

Happy testing! ğŸš€