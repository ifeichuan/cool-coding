---
title: Android UI æµ‹è¯•
description: äº†è§£ Android UI æµ‹è¯•çš„åŸºæœ¬æ¦‚å¿µã€å·¥å…·å’Œå®é™…åº”ç”¨åœºæ™¯ï¼Œå¸®åŠ©åˆå­¦è€…æŒæ¡å¦‚ä½•ç¼–å†™å’Œè¿è¡Œ UI æµ‹è¯•ã€‚
---

## ä»‹ç»

åœ¨ Android å¼€å‘ä¸­ï¼ŒUI æµ‹è¯•æ˜¯ç¡®ä¿åº”ç”¨ç¨‹åºç”¨æˆ·ç•Œé¢æŒ‰é¢„æœŸå·¥ä½œçš„é‡è¦ç¯èŠ‚ã€‚UI æµ‹è¯•é€šè¿‡æ¨¡æ‹Ÿç”¨æˆ·ä¸åº”ç”¨ç¨‹åºçš„äº¤äº’ï¼ŒéªŒè¯ UI ç»„ä»¶çš„æ­£ç¡®æ€§å’Œå“åº”æ€§ã€‚é€šè¿‡ç¼–å†™ UI æµ‹è¯•ï¼Œå¼€å‘è€…å¯ä»¥åœ¨åº”ç”¨ç¨‹åºå‘å¸ƒå‰å‘ç°å¹¶ä¿®å¤æ½œåœ¨çš„ UI é—®é¢˜ï¼Œä»è€Œæå‡ç”¨æˆ·ä½“éªŒã€‚

Android æä¾›äº†å¤šç§å·¥å…·å’Œæ¡†æ¶æ¥æ”¯æŒ UI æµ‹è¯•ï¼Œå…¶ä¸­æœ€å¸¸ç”¨çš„æ˜¯ **Espresso** å’Œ **UI Automator**ã€‚æœ¬æ–‡å°†é‡ç‚¹ä»‹ç»å¦‚ä½•ä½¿ç”¨ Espresso ç¼–å†™å’Œè¿è¡Œ UI æµ‹è¯•ã€‚

---

## ä»€ä¹ˆæ˜¯ Espressoï¼Ÿ

Espresso æ˜¯ Google æä¾›çš„ä¸€ä¸ªè½»é‡çº§ UI æµ‹è¯•æ¡†æ¶ï¼Œä¸“é—¨ç”¨äº Android åº”ç”¨ç¨‹åºçš„ UI æµ‹è¯•ã€‚å®ƒå…è®¸å¼€å‘è€…ç¼–å†™ç®€æ´ã€å¯è¯»æ€§é«˜çš„æµ‹è¯•ä»£ç ï¼Œå¹¶æ”¯æŒä¸ Android å¼€å‘å·¥å…·ï¼ˆå¦‚ Android Studioï¼‰æ— ç¼é›†æˆã€‚

Espresso çš„æ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬ï¼š
- **è§†å›¾åŒ¹é…**ï¼šé€šè¿‡ `onView()` æ–¹æ³•æŸ¥æ‰¾ UI ç»„ä»¶ã€‚
- **æ“ä½œæ¨¡æ‹Ÿ**ï¼šé€šè¿‡ `perform()` æ–¹æ³•æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œï¼Œå¦‚ç‚¹å‡»ã€è¾“å…¥æ–‡æœ¬ç­‰ã€‚
- **æ–­è¨€éªŒè¯**ï¼šé€šè¿‡ `check()` æ–¹æ³•éªŒè¯ UI ç»„ä»¶çš„çŠ¶æ€æ˜¯å¦ç¬¦åˆé¢„æœŸã€‚

---

## è®¾ç½® Espresso

åœ¨å¼€å§‹ç¼–å†™ UI æµ‹è¯•ä¹‹å‰ï¼Œéœ€è¦åœ¨é¡¹ç›®ä¸­æ·»åŠ  Espresso ä¾èµ–é¡¹ã€‚æ‰“å¼€ `build.gradle` æ–‡ä»¶ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼š

```groovy
dependencies {
    androidTestImplementation 'androidx.test.espresso:espresso-core:3.5.1'
    androidTestImplementation 'androidx.test:runner:1.5.2'
    androidTestImplementation 'androidx.test:rules:1.5.0'
}
```

åŒæ­¥é¡¹ç›®åï¼ŒEspresso å°±å¯ä»¥ä½¿ç”¨äº†ã€‚

---

## ç¼–å†™ç¬¬ä¸€ä¸ª UI æµ‹è¯•

å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªç®€å•çš„ç™»å½•ç•Œé¢ï¼ŒåŒ…å«ä¸€ä¸ªç”¨æˆ·åè¾“å…¥æ¡†ã€ä¸€ä¸ªå¯†ç è¾“å…¥æ¡†å’Œä¸€ä¸ªç™»å½•æŒ‰é’®ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯æµ‹è¯•ç”¨æˆ·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç åï¼Œç‚¹å‡»ç™»å½•æŒ‰é’®æ˜¯å¦è·³è½¬åˆ°ä¸»ç•Œé¢ã€‚

### 1. å®šä¹‰æµ‹è¯•ç±»

åœ¨ `androidTest` ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„æµ‹è¯•ç±» `LoginActivityTest`ï¼š

```kotlin
import androidx.test.espresso.Espresso
import androidx.test.espresso.action.ViewActions
import androidx.test.espresso.assertion.ViewAssertions
import androidx.test.espresso.matcher.ViewMatchers
import androidx.test.ext.junit.rules.ActivityScenarioRule
import androidx.test.ext.junit.runners.AndroidJUnit4
import org.junit.Rule
import org.junit.Test
import org.junit.runner.RunWith

@RunWith(AndroidJUnit4::class)
class LoginActivityTest {

    @get:Rule
    val activityRule = ActivityScenarioRule(LoginActivity::class.java)
}
```

### 2. ç¼–å†™æµ‹è¯•æ–¹æ³•

åœ¨ `LoginActivityTest` ç±»ä¸­æ·»åŠ ä¸€ä¸ªæµ‹è¯•æ–¹æ³•ï¼Œæ¨¡æ‹Ÿç”¨æˆ·è¾“å…¥ç”¨æˆ·åå’Œå¯†ç å¹¶ç‚¹å‡»ç™»å½•æŒ‰é’®ï¼š

```kotlin
@Test
fun testLoginSuccess() {
    // è¾“å…¥ç”¨æˆ·å
    Espresso.onView(ViewMatchers.withId(R.id.username_input))
        .perform(ViewActions.typeText("testuser"), ViewActions.closeSoftKeyboard())

    // è¾“å…¥å¯†ç 
    Espresso.onView(ViewMatchers.withId(R.id.password_input))
        .perform(ViewActions.typeText("password123"), ViewActions.closeSoftKeyboard())

    // ç‚¹å‡»ç™»å½•æŒ‰é’®
    Espresso.onView(ViewMatchers.withId(R.id.login_button))
        .perform(ViewActions.click())

    // éªŒè¯æ˜¯å¦è·³è½¬åˆ°ä¸»ç•Œé¢
    Espresso.onView(ViewMatchers.withId(R.id.main_activity_title))
        .check(ViewAssertions.matches(ViewMatchers.isDisplayed()))
}
```

### 3. è¿è¡Œæµ‹è¯•

åœ¨ Android Studio ä¸­å³é”®ç‚¹å‡»æµ‹è¯•ç±»æˆ–æµ‹è¯•æ–¹æ³•ï¼Œé€‰æ‹© **Run** å³å¯è¿è¡Œæµ‹è¯•ã€‚å¦‚æœæµ‹è¯•é€šè¿‡ï¼Œè¯´æ˜ç™»å½•åŠŸèƒ½æŒ‰é¢„æœŸå·¥ä½œã€‚

---

## å®é™…åº”ç”¨åœºæ™¯

UI æµ‹è¯•åœ¨å®é™…å¼€å‘ä¸­æœ‰å¹¿æ³›çš„åº”ç”¨åœºæ™¯ï¼Œä¾‹å¦‚ï¼š
1. **è¡¨å•éªŒè¯**ï¼šæµ‹è¯•ç”¨æˆ·è¾“å…¥æ˜¯å¦ç¬¦åˆè¦æ±‚ã€‚
2. **å¯¼èˆªæµ‹è¯•**ï¼šéªŒè¯ç‚¹å‡»æŒ‰é’®æˆ–èœå•é¡¹åæ˜¯å¦è·³è½¬åˆ°æ­£ç¡®çš„ç•Œé¢ã€‚
3. **çŠ¶æ€éªŒè¯**ï¼šæµ‹è¯• UI ç»„ä»¶åœ¨ä¸åŒçŠ¶æ€ä¸‹çš„æ˜¾ç¤ºæ˜¯å¦æ­£ç¡®ã€‚

:::tip
åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œå»ºè®®å°† UI æµ‹è¯•ä¸æŒç»­é›†æˆï¼ˆCIï¼‰å·¥å…·ç»“åˆï¼Œç¡®ä¿æ¯æ¬¡ä»£ç æäº¤åéƒ½èƒ½è‡ªåŠ¨è¿è¡Œæµ‹è¯•ã€‚
:::

---

## æ€»ç»“

é€šè¿‡æœ¬æ–‡ï¼Œæˆ‘ä»¬å­¦ä¹ äº† Android UI æµ‹è¯•çš„åŸºæœ¬æ¦‚å¿µï¼Œå¹¶ä½¿ç”¨ Espresso ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„ UI æµ‹è¯•ã€‚UI æµ‹è¯•æ˜¯ç¡®ä¿åº”ç”¨ç¨‹åºè´¨é‡çš„é‡è¦æ‰‹æ®µï¼Œå»ºè®®å¼€å‘è€…åœ¨å¼€å‘è¿‡ç¨‹ä¸­å…»æˆç¼–å†™æµ‹è¯•çš„ä¹ æƒ¯ã€‚

---

## é™„åŠ èµ„æºä¸ç»ƒä¹ 

### èµ„æº
- [Espresso å®˜æ–¹æ–‡æ¡£](https://developer.android.com/training/testing/espresso)
- [Android Testing Codelab](https://developer.android.com/codelabs/android-testing)

### ç»ƒä¹ 
1. ä¸ºä½ çš„åº”ç”¨ç¨‹åºç¼–å†™ä¸€ä¸ª UI æµ‹è¯•ï¼ŒéªŒè¯ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½ã€‚
2. å°è¯•ä½¿ç”¨ `UI Automator` ç¼–å†™è·¨åº”ç”¨çš„ UI æµ‹è¯•ã€‚
3. å°† UI æµ‹è¯•é›†æˆåˆ° CI å·¥å…·ï¼ˆå¦‚ GitHub Actions æˆ– Jenkinsï¼‰ä¸­ã€‚

Happy Testing! ğŸš€