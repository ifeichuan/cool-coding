---
title: SkyWalking Slacké€šçŸ¥é›†æˆ
description: "å­¦ä¹ å¦‚ä½•å°†SkyWalkingå‘Šè­¦ç³»ç»Ÿä¸Slacké›†æˆï¼Œå®ç°å®æ—¶ç›‘æ§é€šçŸ¥æ¨é€ã€‚åŒ…å«é…ç½®æ­¥éª¤ã€ä»£ç ç¤ºä¾‹å’Œå®é™…åº”ç”¨åœºæ™¯ã€‚"
---

## ç®€ä»‹

SkyWalkingçš„å‘Šè­¦ç³»ç»Ÿèƒ½å¤Ÿç›‘æ§åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¥åº·çŠ¶æ€ï¼Œè€ŒSlackæ˜¯å›¢é˜Ÿåä½œä¸­å¹¿æ³›ä½¿ç”¨çš„å³æ—¶é€šè®¯å·¥å…·ã€‚é€šè¿‡å°†ä¸¤è€…é›†æˆï¼Œå›¢é˜Ÿå¯ä»¥å®æ—¶æ¥æ”¶ç³»ç»Ÿå‘Šè­¦é€šçŸ¥ï¼Œå¿«é€Ÿå“åº”é—®é¢˜ã€‚æœ¬ç« å°†è¯¦ç»†ä»‹ç»å¦‚ä½•é…ç½®SkyWalkingä¸Slackçš„é›†æˆã€‚

## å‰ç½®æ¡ä»¶

1. å·²éƒ¨ç½²SkyWalking OAP Serverï¼ˆç‰ˆæœ¬â‰¥8.4.0ï¼‰
2. æ‹¥æœ‰Slackå·¥ä½œåŒºæƒé™ï¼Œå¹¶å·²åˆ›å»º[Incoming Webhook](https://api.slack.com/messaging/webhooks)

---

## é…ç½®æ­¥éª¤

### 1. åˆ›å»ºSlack Webhook
åœ¨Slackä¸­æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š
1. è¿›å…¥ã€ŒSettings & administrationã€ > ã€ŒManage appsã€
2. æœç´¢ã€ŒIncoming Webhookã€ï¼Œæ·»åŠ è‡³ç›®æ ‡é¢‘é“
3. å¤åˆ¶ç”Ÿæˆçš„Webhook URLï¼ˆæ ¼å¼å¦‚ï¼š`https://hooks.slack.com/services/XXXX/YYYY/ZZZZ`ï¼‰

### 2. ä¿®æ”¹SkyWalkingå‘Šè­¦é…ç½®
ç¼–è¾‘SkyWalkingé…ç½®æ–‡ä»¶ `config/alarm-settings.yml`ï¼š

```yaml
rules:
  service_resp_time_rule:
    expression: service_resp_time > 1000
    period: 10
    silence-period: 5
    message: Service {name} å“åº”æ—¶é—´è¶…è¿‡é˜ˆå€¼: {value}ms

webhooks:
  - name: "slack-notification"
    url: "YOUR_SLACK_WEBHOOK_URL"
    secret: "optional_signature"
```

:::note
`secret` å­—æ®µå¯é€‰ï¼Œç”¨äºSlackçš„ç­¾åéªŒè¯ï¼ˆéœ€ä¸Slacké…ç½®åŒ¹é…ï¼‰
:::

### 3. é…ç½®å‘Šè­¦æ¨¡æ¿ï¼ˆå¯é€‰ï¼‰
åˆ›å»ºè‡ªå®šä¹‰æ¶ˆæ¯æ¨¡æ¿ `config/slack-template.yml`ï¼š

```yaml
text: |-
  :red_circle: *SkyWalkingå‘Šè­¦*
  *æœåŠ¡*: {name}
  *å‘Šè­¦å†…å®¹*: {message}
  *æ—¶é—´*: {time}
  *è¯¦æƒ…*: {console}
```

åœ¨ `alarm-settings.yml` ä¸­å¼•ç”¨æ¨¡æ¿ï¼š
```yaml
webhooks:
  - name: "slack-notification"
    url: "YOUR_WEBHOOK_URL"
    template: "slack-template.yml"
```

---

## å®é™…æ¡ˆä¾‹

### åœºæ™¯ï¼šç”µå•†å¹³å°ç›‘æ§
æŸç”µå•†å›¢é˜Ÿé…ç½®äº†ä»¥ä¸‹è§„åˆ™ç›‘æ§æ”¯ä»˜æœåŠ¡ï¼š
```yaml
rules:
  payment_service_error_rule:
    expression: service_resp_time > 2000 || service_error_rate > 0.1
    message: æ”¯ä»˜æœåŠ¡å¼‚å¸¸ï¼å“åº”æ—¶é—´: {value}ms
```

å½“è§¦å‘å‘Šè­¦æ—¶ï¼ŒSlackä¼šæ”¶åˆ°å¦‚ä¸‹é€šçŸ¥ï¼š
```
ğŸ›‘ *SkyWalkingå‘Šè­¦*
æœåŠ¡: payment-service
å‘Šè­¦å†…å®¹: å“åº”æ—¶é—´è¶…è¿‡é˜ˆå€¼: 2150ms
æ—¶é—´: 2023-08-20 14:30:45
è¯¦æƒ…: http://skywalking-ui/alert-details/123
```

---

## éªŒè¯é…ç½®

1. æ‰‹åŠ¨è§¦å‘æµ‹è¯•å‘Šè­¦ï¼š
```bash
curl -X POST http://OAP_SERVER:12800/v3/alarm/watcher/trigger \
  -H 'Content-Type: application/json' \
  -d '{"scope":"SERVICE","id":"test-service","message":"Test alert"}'
```

2. æ£€æŸ¥Slacké¢‘é“æ˜¯å¦æ”¶åˆ°æµ‹è¯•æ¶ˆæ¯ï¼š

```mermaid
sequenceDiagram
    participant OAP as SkyWalking OAP
    participant Slack
    OAP->>Slack: POST å‘Šè­¦JSON
    Slack-->>OAP: 200 OK
    Note over Slack: æ˜¾ç¤ºæ ¼å¼åŒ–æ¶ˆæ¯
```

---

## é«˜çº§é…ç½®

### æ¶ˆæ¯æ ¼å¼åŒ–
ä½¿ç”¨Slackçš„[Block Kit](https://api.slack.com/block-kit)å¢å¼ºå¯è¯»æ€§ï¼š
```yaml
text: |
  {
    "blocks": [
      {
        "type": "section",
        "text": {
          "type": "mrkdwn",
          "text": "*:warning: SkyWalkingå‘Šè­¦*"
        }
      },
      {
        "type": "divider"
      }
    ]
  }
```

### å¤šç¯å¢ƒåŒºåˆ†
é€šè¿‡`tags`åŒºåˆ†ä¸åŒç¯å¢ƒï¼š
```yaml
webhooks:
  - name: "prod-slack"
    url: "PROD_WEBHOOK"
    tags:
      env: "production"
```

---

## æ€»ç»“

é€šè¿‡æœ¬æŒ‡å—ï¼Œä½ å·²å­¦ä¼šï¼š
- é…ç½®SkyWalkingä¸Slackçš„åŸºç¡€é›†æˆ
- è‡ªå®šä¹‰å‘Šè­¦æ¶ˆæ¯æ¨¡æ¿
- éªŒè¯é€šçŸ¥é“¾è·¯
- å®ç°é«˜çº§æ¶ˆæ¯æ ¼å¼åŒ–

:::tip æ‰©å±•ç»ƒä¹ 
1. å°è¯•ä¸ºä¸åŒä¸¥é‡çº§åˆ«çš„å‘Šè­¦è®¾ç½®ä¸åŒSlacké¢‘é“
2. åœ¨æ¶ˆæ¯ä¸­æ·»åŠ ç›´æ¥è·³è½¬åˆ°SkyWalking Dashboardçš„é“¾æ¥
3. é…ç½®å‘Šè­¦è‡ªåŠ¨æ¢å¤é€šçŸ¥
:::

## å¸¸è§é—®é¢˜

**Qï¼šæ”¶ä¸åˆ°Slacké€šçŸ¥æ€ä¹ˆåŠï¼Ÿ**  
Aï¼šæŒ‰ä»¥ä¸‹æ­¥éª¤æ’æŸ¥ï¼š
1. æ£€æŸ¥OAPæ—¥å¿— `logs/oap.log` æ˜¯å¦æœ‰å‘é€é”™è¯¯
2. ä½¿ç”¨`curl -X POST WEBHOOK_URL -d '{"text":"test"}'` æµ‹è¯•Webhook
3. ç¡®è®¤SkyWalkingå‘Šè­¦è§„åˆ™å·²æ­£ç¡®è§¦å‘

**Qï¼šå¦‚ä½•é™åˆ¶å‘Šè­¦é¢‘ç‡ï¼Ÿ**  
Aï¼šè°ƒæ•´`alarm-settings.yml`ä¸­çš„`period`å’Œ`silence-period`å‚æ•°ï¼š
```yaml
rules:
  high_cpu_rule:
    silence-period: 15m # 15åˆ†é’Ÿå†…ä¸é‡å¤å‘Šè­¦
```

---

## é™„åŠ èµ„æº

1. [SkyWalkingå®˜æ–¹å‘Šè­¦æ–‡æ¡£](https://skywalking.apache.org/docs/main/latest/en/setup/backend/backend-alarm/)
2. [Slack Incoming WebhooksæŒ‡å—](https://api.slack.com/messaging/webhooks)
3. [Block Kit Builderäº¤äº’å·¥å…·](https://app.slack.com/block-kit-builder)