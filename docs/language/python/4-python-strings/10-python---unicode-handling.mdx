---
title: Python Unicodeå¤„ç†
description: å­¦ä¹ Pythonä¸­å¦‚ä½•å¤„ç†Unicodeå­—ç¬¦ä¸²ã€ç¼–ç è§£ç ä»¥åŠç›¸å…³æ“ä½œï¼Œäº†è§£å›½é™…åŒ–æ–‡æœ¬å¤„ç†çš„åŸºç¡€çŸ¥è¯†
---

# Python Unicodeå¤„ç†

## Unicodeç®€ä»‹

åœ¨å…¨çƒåŒ–çš„æ•°å­—ä¸–ç•Œä¸­ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†å„ç§è¯­è¨€å’Œç¬¦å·ã€‚Unicodeæ˜¯ä¸€ç§å­—ç¬¦ç¼–ç æ ‡å‡†ï¼Œå®ƒä¸ºä¸–ç•Œä¸Šå‡ ä¹æ‰€æœ‰çš„å­—ç¬¦æä¾›äº†å”¯ä¸€çš„æ•°å­—æ ‡è¯†ï¼ˆä»£ç ç‚¹ï¼‰ã€‚Python 3åœ¨è®¾è®¡ä¸Šå¯¹Unicodeæä¾›äº†å‡ºè‰²çš„æ”¯æŒï¼Œè¿™è®©Pythonæˆä¸ºå¤„ç†å›½é™…åŒ–æ–‡æœ¬çš„ç†æƒ³é€‰æ‹©ã€‚

:::note
Python 3ä¸­ï¼Œæ‰€æœ‰çš„å­—ç¬¦ä¸²é»˜è®¤éƒ½æ˜¯Unicodeå­—ç¬¦ä¸²ï¼Œè¿™ä¸Python 2æœ‰å¾ˆå¤§ä¸åŒï¼ˆPython 2ä¸­éœ€è¦ç‰¹åˆ«æ ‡è®°Unicodeå­—ç¬¦ä¸²ï¼‰ã€‚
:::

## Unicodeä¸å­—ç¬¦ç¼–ç åŸºç¡€

åœ¨ç†è§£Pythonçš„Unicodeå¤„ç†ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®å‡ ä¸ªåŸºæœ¬æ¦‚å¿µï¼š

- **å­—ç¬¦(Character)**: äººç±»å¯è¯»çš„ç¬¦å·ï¼Œå¦‚å­—æ¯ã€æ•°å­—ã€æ ‡ç‚¹ç¬¦å·ç­‰
- **ä»£ç ç‚¹(Code Point)**: Unicodeä¸ºæ¯ä¸ªå­—ç¬¦åˆ†é…çš„å”¯ä¸€æ•°å€¼
- **ç¼–ç (Encoding)**: å°†ä»£ç ç‚¹è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—çš„è§„åˆ™ï¼ˆä¾‹å¦‚UTF-8ã€UTF-16ç­‰ï¼‰

```mermaid
graph LR
    A[å­—ç¬¦ 'A'] --> B[Unicodeä»£ç ç‚¹ U+0041]
    B --> C[UTF-8ç¼–ç  01000001]
    B --> D[UTF-16ç¼–ç  00000000 01000001]
```

## Python ä¸­çš„Unicodeå­—ç¬¦ä¸²

åœ¨Python 3ä¸­ï¼Œ`str`ç±»å‹è¡¨ç¤ºUnicodeå­—ç¬¦ä¸²ï¼Œè€Œ`bytes`ç±»å‹è¡¨ç¤ºå­—èŠ‚åºåˆ—ã€‚

### åˆ›å»ºUnicodeå­—ç¬¦ä¸²

```python
# æ™®é€šå­—ç¬¦ä¸²(é»˜è®¤ä¸ºUnicode)
s1 = "Hello, World!"

# æ˜¾å¼Unicodeå­—ç¬¦ä¸²(ä½¿ç”¨Unicodeè½¬ä¹‰åºåˆ—)
s2 = "Hello, \u4E16\u754C"  # Hello, ä¸–ç•Œ

print(s1)
print(s2)
```

è¾“å‡º:
```
Hello, World!
Hello, ä¸–ç•Œ
```

### Unicodeè½¬ä¹‰åºåˆ—

Pythonæ”¯æŒå¤šç§Unicodeå­—ç¬¦è¡¨ç¤ºæ–¹æ³•ï¼š

```python
# \u åæ¥å››ä¸ªåå…­è¿›åˆ¶æ•°å­—(è¡¨ç¤ºBMPå¹³é¢çš„å­—ç¬¦)
chinese = "\u4E2D\u6587"  # ä¸­æ–‡

# \U åæ¥å…«ä¸ªåå…­è¿›åˆ¶æ•°å­—(è¡¨ç¤ºè¶…å‡ºBMPå¹³é¢çš„å­—ç¬¦)
emoji = "\U0001F600"  # ğŸ˜€

# ä½¿ç”¨Unicodeå­—ç¬¦åç§°
omega = "\N{GREEK CAPITAL LETTER OMEGA}"  # Î©

print(chinese)
print(emoji)
print(omega)
```

è¾“å‡º:
```
ä¸­æ–‡
ğŸ˜€
Î©
```

## ç¼–ç ä¸è§£ç 

ç¼–ç å’Œè§£ç æ˜¯Unicodeå¤„ç†ä¸­æœ€åŸºæœ¬çš„æ“ä½œã€‚

### ç¼–ç (Unicode â†’ å­—èŠ‚)

```python
text = "ä½ å¥½ï¼Œä¸–ç•Œï¼"
print(f"åŸå§‹æ–‡æœ¬: {text}")

# ä½¿ç”¨UTF-8ç¼–ç 
utf8_bytes = text.encode('utf-8')
print(f"UTF-8ç¼–ç : {utf8_bytes}")

# ä½¿ç”¨UTF-16ç¼–ç 
utf16_bytes = text.encode('utf-16')
print(f"UTF-16ç¼–ç : {utf16_bytes}")

# ä½¿ç”¨GBKç¼–ç (ä¸­æ–‡å¸¸ç”¨)
gbk_bytes = text.encode('gbk')
print(f"GBKç¼–ç : {gbk_bytes}")
```

è¾“å‡º:
```
åŸå§‹æ–‡æœ¬: ä½ å¥½ï¼Œä¸–ç•Œï¼
UTF-8ç¼–ç : b'\xe4\xbd\xa0\xe5\xa5\xbd\xef\xbc\x8c\xe4\xb8\x96\xe7\x95\x8c\xef\xbc\x81'
UTF-16ç¼–ç : b'\xff\xfe`N}Y\x0cV\x1aV\x16R!'
GBKç¼–ç : b'\xc4\xe3\xba\xc3\xa3\xac\xca\xc0\xbd\xe7\xa3\xa1'
```

### è§£ç (å­—èŠ‚ â†’ Unicode)

```python
# ä»UTF-8è§£ç 
decoded_utf8 = utf8_bytes.decode('utf-8')
print(f"UTF-8è§£ç : {decoded_utf8}")

# ä»UTF-16è§£ç 
decoded_utf16 = utf16_bytes.decode('utf-16')
print(f"UTF-16è§£ç : {decoded_utf16}")

# ä»GBKè§£ç 
decoded_gbk = gbk_bytes.decode('gbk')
print(f"GBKè§£ç : {decoded_gbk}")
```

è¾“å‡º:
```
UTF-8è§£ç : ä½ å¥½ï¼Œä¸–ç•Œï¼
UTF-16è§£ç : ä½ å¥½ï¼Œä¸–ç•Œï¼
GBKè§£ç : ä½ å¥½ï¼Œä¸–ç•Œï¼
```

:::caution
å¦‚æœä½¿ç”¨é”™è¯¯çš„ç¼–ç æ–¹å¼è§£ç ï¼Œä¼šå¼•å‘`UnicodeDecodeError`é”™è¯¯ã€‚åœ¨è§£ç æ—¶ï¼Œå¿…é¡»çŸ¥é“æ•°æ®çš„åŸå§‹ç¼–ç ã€‚
:::

### å¤„ç†ç¼–ç é”™è¯¯

Pythonæä¾›äº†å¤šç§å¤„ç†ç¼–ç /è§£ç é”™è¯¯çš„æ–¹å¼ï¼š

```python
text = "ä½ å¥½ï¼Œä¸–ç•Œï¼"

# å°è¯•ä½¿ç”¨asciiç¼–ç (ä¸æ”¯æŒä¸­æ–‡)
try:
    ascii_bytes = text.encode('ascii')
except UnicodeEncodeError as e:
    print(f"é”™è¯¯: {e}")

# ä½¿ç”¨é”™è¯¯å¤„ç†é€‰é¡¹
ascii_bytes_ignore = text.encode('ascii', errors='ignore')
print(f"å¿½ç•¥é”™è¯¯: {ascii_bytes_ignore}")

ascii_bytes_replace = text.encode('ascii', errors='replace')
print(f"æ›¿æ¢é”™è¯¯: {ascii_bytes_replace}")

ascii_bytes_xmlcharrefreplace = text.encode('ascii', errors='xmlcharrefreplace')
print(f"XMLæ›¿æ¢: {ascii_bytes_xmlcharrefreplace}")
```

è¾“å‡º:
```
é”™è¯¯: 'ascii' codec can't encode character '\u4f60' in position 0: ordinal not in range(128)
å¿½ç•¥é”™è¯¯: b''
æ›¿æ¢é”™è¯¯: b'??????'
XMLæ›¿æ¢: b'&#20320;&#22909;&#65292;&#19990;&#30028;&#65281;'
```

å¸¸ç”¨é”™è¯¯å¤„ç†é€‰é¡¹ï¼š
- `strict`ï¼šé»˜è®¤é€‰é¡¹ï¼Œé‡åˆ°é”™è¯¯æ—¶æŠ›å‡ºå¼‚å¸¸
- `ignore`ï¼šå¿½ç•¥æ— æ³•ç¼–ç /è§£ç çš„å­—ç¬¦
- `replace`ï¼šç”¨é—®å·æ›¿æ¢æ— æ³•ç¼–ç /è§£ç çš„å­—ç¬¦
- `xmlcharrefreplace`ï¼š(ä»…ç¼–ç æ—¶)ä½¿ç”¨XMLå­—ç¬¦å¼•ç”¨

## Unicodeå­—ç¬¦å±æ€§å’Œæ“ä½œ

Pythonçš„`unicodedata`æ¨¡å—æä¾›äº†è®¸å¤šUnicodeå­—ç¬¦åˆ†æå·¥å…·ã€‚

```python
import unicodedata

# è·å–å­—ç¬¦çš„Unicodeåç§°
char = 'Ã©'
name = unicodedata.name(char)
print(f"å­—ç¬¦ '{char}' çš„Unicodeåç§°: {name}")

# é€šè¿‡åç§°æŸ¥æ‰¾å­—ç¬¦
char_from_name = unicodedata.lookup("LATIN SMALL LETTER E WITH ACUTE")
print(f"åç§°å¯¹åº”çš„å­—ç¬¦: {char_from_name}")

# è·å–è§„èŒƒåŒ–å½¢å¼
text = "cafÃ©"  # åŒ…å«ç»„åˆå­—ç¬¦
nfc = unicodedata.normalize('NFC', text)  # ç»„åˆå½¢å¼
nfd = unicodedata.normalize('NFD', text)  # åˆ†è§£å½¢å¼

print(f"åŸå§‹æ–‡æœ¬: {text}")
print(f"NFCå½¢å¼: {nfc}, é•¿åº¦: {len(nfc)}")
print(f"NFDå½¢å¼: {nfd}, é•¿åº¦: {len(nfd)}")
print(f"NFCå­—ç¬¦ç¼–ç : {[hex(ord(c)) for c in nfc]}")
print(f"NFDå­—ç¬¦ç¼–ç : {[hex(ord(c)) for c in nfd]}")
```

è¾“å‡º:
```
å­—ç¬¦ 'Ã©' çš„Unicodeåç§°: LATIN SMALL LETTER E WITH ACUTE
åç§°å¯¹åº”çš„å­—ç¬¦: Ã©
åŸå§‹æ–‡æœ¬: cafÃ©
NFCå½¢å¼: cafÃ©, é•¿åº¦: 4
NFDå½¢å¼: cafÃ©, é•¿åº¦: 5
NFCå­—ç¬¦ç¼–ç : ['0x63', '0x61', '0x66', '0xe9']
NFDå­—ç¬¦ç¼–ç : ['0x63', '0x61', '0x66', '0x65', '0x301']
```

## å®é™…åº”ç”¨æ¡ˆä¾‹

### æ¡ˆä¾‹1ï¼šè¯»å–ä¸åŒç¼–ç çš„æ–‡ä»¶

```python
def read_file_with_encoding(filename, encoding):
    try:
        with open(filename, 'r', encoding=encoding) as f:
            return f.read()
    except UnicodeDecodeError:
        print(f"æ— æ³•ä½¿ç”¨{encoding}ç¼–ç è¯»å–æ–‡ä»¶")
        return None

# å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªUTF-8ç¼–ç çš„æ–‡ä»¶å’Œä¸€ä¸ªGBKç¼–ç çš„æ–‡ä»¶
# utf8_content = read_file_with_encoding('utf8_file.txt', 'utf-8')
# gbk_content = read_file_with_encoding('gbk_file.txt', 'gbk')
```

### æ¡ˆä¾‹2ï¼šç½‘ç»œè¯·æ±‚ä¸­çš„ç¼–ç å¤„ç†

```python
import requests

def fetch_webpage(url):
    response = requests.get(url)
    
    # å°è¯•æ£€æµ‹ç¼–ç 
    encoding = response.encoding
    print(f"æ£€æµ‹åˆ°çš„ç¼–ç : {encoding}")
    
    # ä½¿ç”¨æ£€æµ‹åˆ°çš„ç¼–ç 
    content = response.text
    
    # å¦‚æœéœ€è¦ï¼Œå¯ä»¥å¼ºåˆ¶ä½¿ç”¨ç‰¹å®šç¼–ç 
    # response.encoding = 'utf-8'
    # content = response.text
    
    return content

# ç¤ºä¾‹ï¼šè·å–ç½‘é¡µ
# webpage = fetch_webpage('https://www.example.com')
# print(webpage[:100])  # æ‰“å°å‰100ä¸ªå­—ç¬¦
```

### æ¡ˆä¾‹3ï¼šå¤šè¯­è¨€æ–‡æœ¬æ’åº

```python
import locale

def sort_multilingual_text(text_list, language_code):
    try:
        # å°è¯•è®¾ç½®åŒºåŸŸè®¾ç½®
        locale.setlocale(locale.LC_COLLATE, language_code)
        
        # æ ¹æ®å½“å‰åŒºåŸŸè®¾ç½®æ’åº
        sorted_list = sorted(text_list, key=locale.strxfrm)
        return sorted_list
    except locale.Error:
        print(f"ä¸æ”¯æŒçš„åŒºåŸŸè®¾ç½®: {language_code}")
        # é€€å›åˆ°é»˜è®¤æ’åº
        return sorted(text_list)

# ç¤ºä¾‹ï¼šæŒ‰è¥¿ç­ç‰™è¯­è§„åˆ™æ’åº
spanish_words = ["Ã±andÃº", "naranja", "Ã±u", "niÃ±o", "manzana"]
sorted_default = sorted(spanish_words)
sorted_spanish = sort_multilingual_text(spanish_words, 'es_ES.UTF-8')  # åœ¨æ”¯æŒæ­¤åŒºåŸŸçš„ç³»ç»Ÿä¸Š

print(f"é»˜è®¤æ’åº: {sorted_default}")
print(f"è¥¿ç­ç‰™è¯­æ’åº: {sorted_spanish}")
```

è¾“å‡ºï¼ˆå–å†³äºç³»ç»Ÿæ”¯æŒï¼‰:
```
é»˜è®¤æ’åº: ['manzana', 'naranja', 'niÃ±o', 'Ã±andÃº', 'Ã±u']
è¥¿ç­ç‰™è¯­æ’åº: ['manzana', 'naranja', 'niÃ±o', 'Ã±andÃº', 'Ã±u']
```

## Unicodeçš„å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### 1. æ–‡ä»¶ç¼–ç æ£€æµ‹

```python
import chardet

def detect_encoding(file_path):
    # è¯»å–æ–‡ä»¶çš„äºŒè¿›åˆ¶æ•°æ®
    with open(file_path, 'rb') as f:
        raw_data = f.read()
    
    # æ£€æµ‹ç¼–ç 
    result = chardet.detect(raw_data)
    encoding = result['encoding']
    confidence = result['confidence']
    
    print(f"æ£€æµ‹åˆ°çš„ç¼–ç : {encoding} (ç½®ä¿¡åº¦: {confidence})")
    return encoding

# ç¤ºä¾‹ç”¨æ³•
# encoding = detect_encoding('unknown_encoding.txt')
# if encoding:
#     with open('unknown_encoding.txt', 'r', encoding=encoding) as f:
#         text = f.read()
#         print(text)
```

### 2. è§„èŒƒåŒ–å¤„ç†

```python
def normalize_unicode_text(text, form='NFC'):
    """
    è§„èŒƒåŒ–Unicodeæ–‡æœ¬ï¼Œä½¿å…¶æ›´å®¹æ˜“æ¯”è¾ƒ
    formå¯ä»¥æ˜¯: 'NFC', 'NFKC', 'NFD', æˆ– 'NFKD'
    """
    import unicodedata
    return unicodedata.normalize(form, text)

# ç¤ºä¾‹
text1 = "cafÃ©"  # ä½¿ç”¨ç»„åˆå­—ç¬¦
text2 = "cafÃ©"  # ä½¿ç”¨é¢„ç»„åˆå­—ç¬¦

print(f"åŸå§‹æ¯”è¾ƒ: {text1 == text2}")
print(f"è§„èŒƒåŒ–åæ¯”è¾ƒ: {normalize_unicode_text(text1) == normalize_unicode_text(text2)}")
```

è¾“å‡º:
```
åŸå§‹æ¯”è¾ƒ: False
è§„èŒƒåŒ–åæ¯”è¾ƒ: True
```

## æ€»ç»“

Unicodeå¤„ç†æ˜¯Pythonç¼–ç¨‹ä¸­å¤„ç†æ–‡æœ¬çš„åŸºç¡€çŸ¥è¯†ï¼Œç‰¹åˆ«æ˜¯åœ¨å¼€å‘å›½é™…åŒ–åº”ç”¨ç¨‹åºæ—¶ã€‚æœ¬æ–‡æ¶µç›–äº†ä»¥ä¸‹å†…å®¹ï¼š

1. UnicodeåŸºç¡€æ¦‚å¿µâ€”â€”å­—ç¬¦ã€ä»£ç ç‚¹å’Œç¼–ç 
2. Pythonä¸­åˆ›å»ºå’Œå¤„ç†Unicodeå­—ç¬¦ä¸²çš„æ–¹æ³•
3. å­—ç¬¦ä¸²çš„ç¼–ç ä¸è§£ç æ“ä½œ
4. å¤„ç†Unicodeå±æ€§å’Œè§„èŒƒåŒ–
5. å®é™…åº”ç”¨æ¡ˆä¾‹ä¸­çš„Unicodeå¤„ç†

æŒæ¡Unicodeå¤„ç†èƒ½åŠ›å°†ä½¿ä½ çš„ç¨‹åºèƒ½å¤Ÿæ›´å¥½åœ°å¤„ç†å„ç§è¯­è¨€å’Œç¬¦å·ï¼Œé¿å…å­—ç¬¦é›†ç›¸å…³çš„é—®é¢˜ã€‚

## ç»ƒä¹ 

1. åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²å¹¶æ‰“å°å‡ºå…¶ä¸­æ¯ä¸ªå­—ç¬¦çš„Unicodeä»£ç ç‚¹ã€‚
2. ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œè¯»å–ä¸€ä¸ªUTF-8ç¼–ç çš„æ–‡ä»¶ï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºGBKç¼–ç ä¿å­˜ã€‚
3. å°è¯•æ¯”è¾ƒä¸åŒè§„èŒƒåŒ–å½¢å¼ä¸‹çš„Unicodeå­—ç¬¦ä¸²ã€‚
4. åˆ›å»ºä¸€ä¸ªèƒ½æ£€æµ‹å¹¶æ­£ç¡®è¯»å–ä¸åŒç¼–ç æ–‡ä»¶çš„å·¥å…·å‡½æ•°ã€‚

## é™„åŠ èµ„æº

- [Python Unicode HOWTO](https://docs.python.org/3/howto/unicode.html)
- [Unicodeæ ‡å‡†](https://www.unicode.org/standard/standard.html)
- [Python unicodedataæ¨¡å—æ–‡æ¡£](https://docs.python.org/3/library/unicodedata.html)

:::tip
å½“å¤„ç†Unicodeå’Œä¸åŒç¼–ç æ—¶ï¼Œæœ€ä½³å®è·µæ˜¯åœ¨ç¨‹åºçš„è¾¹ç•Œè¿›è¡Œç¼–ç /è§£ç ï¼ˆå¦‚æ–‡ä»¶I/Oã€ç½‘ç»œè¯·æ±‚ï¼‰ï¼Œè€Œåœ¨ç¨‹åºå†…éƒ¨å§‹ç»ˆä½¿ç”¨Unicodeå­—ç¬¦ä¸²ã€‚è¿™ç§æ–¹æ³•è¢«ç§°ä¸º"Unicodeä¸‰æ˜æ²»"ã€‚
:::